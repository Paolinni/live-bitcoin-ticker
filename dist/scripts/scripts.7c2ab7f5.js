angular.module("myMvpProjectApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","LocalStorageModule"]).config(["$routeProvider",function(a){a.when("/todos",{templateUrl:"views/todos.html",controller:"TodoController"}).when("/bitcoin",{templateUrl:"views/bitcoin.html",controller:"GraphController"}).otherwise({redirectTo:"/"})}]).factory("Ticker",["$http",function(a){var b=function(){return a({method:"GET",url:"https://api.bitcoinaverage.com/ticker/USD"}).then(function(a){return console.log("res data: ",a),a})};return{fetchData:b}}]),angular.module("myMvpProjectApp").controller("TodoController",["$scope","localStorageService",function(a,b){var c=b.get("todos");a.todos=c||["bob","cheese"],a.$watch("todos",function(){b.set("todos",a.todos)},!0),a.todo="",a.addTodo=function(){-1!==a.todos.indexOf(a.todo)?alert("That todo already exists!"):a.todo&&(a.todos.push(a.todo),a.todo=""),console.log("localStorage: ",a.todos)},a.removeTodo=function(b){a.todos.splice(b,1),console.log("localStorage: ",a.todos)}}]),angular.module("myMvpProjectApp").controller("GraphController",["$scope","$interval","Ticker","localStorageService",function(a,b,c,d){a.countDownNewTick=0;var e,f=d.get("coinData");a.coinData=f||[{hour:1,value:461}],a.$watch("coinData",function(){d.set("coinData",a.coinData)},!0),a.liveTick="",a.getLiveTicks=function(){c.fetchData().then(function(c){console.log("tick: ",c),a.liveTick=c,a.coinData.push({hour:a.coinData.length+1,value:c.data.last}),a.countDownNewTick=9,b.cancel(e),e=b(function(){a.countDownNewTick--},1e3),console.log("liveTick: ",a.liveTick)})["catch"](function(a){console.log(a),console.error(a)})},b(function(){a.getLiveTicks()},1e4)}]).directive("linearChart",["$parse","$window",function(a,b){return{restrict:"EA",template:"<svg width='850' height='200'></svg>",link:function(c,d,e){function f(){i=r.scale.linear().domain([o[0].hour,o[o.length-1].hour]).range([p+5,s.attr("width")-p]),j=r.scale.linear().domain([r.min(o,function(a){return a.value}),r.max(o,function(a){return a.value})]).range([s.attr("height")-p,0]),k=r.svg.axis().scale(i).orient("bottom").ticks(6),l=r.svg.axis().scale(j).orient("left").ticks(10),m=r.svg.line().x(function(a){return i(a.hour)}).y(function(a){return j(a.value)}).interpolate("linear")}function g(){f(),t.append("svg:g").attr("class","x axis").attr("transform","translate(12,178)").call(k),t.append("svg:g").attr("class","y axis").attr("transform","translate(40,0)").call(l),t.append("svg:path").attr({d:m(o),stroke:"blue","stroke-width":2,fill:"none","class":q})}function h(){f(),t.selectAll("g.y.axis").call(l),t.selectAll("g.x.axis").call(k),t.selectAll("."+q).attr({d:m(o)})}var i,j,k,l,m,n=a(e.chartData),o=n(c),p=25,q="path",r=b.d3,s=d.find("svg"),t=r.select(s[0]);c.$watchCollection(n,function(a,b){o=a,h()}),g()}}}]),angular.module("myMvpProjectApp").run(["$templateCache",function(a){"use strict";a.put("views/bitcoin.html",'<div class="container" ng-controller="GraphController"> <h2>Live Bitcoin Ticker</h2> <h1> <span class="tick-price-txt">Current Value: </span> <span type="text" class="tick-price">{{ liveTick.data.last | currency }}</span> Updates in: <span class="counter">{{ countDownNewTick }}</span> </h1> <div> <div linear-chart chart-data="coinData"></div> </div> </div>'),a.put("views/todos.html",'<div class="container"> <h2>My Todos</h2> <form role="form" ng-submit="addTodo()"> <div class="row"> <div class="input-group"> <input type="text" ng-model="todo" placeholder="What todo?" class="form-control"> <span class="input-group-btn"> <input type="submit" class="btn btn-primary" value="Add"> </span> </div> </div> </form> <p class="input-group" ng-repeat="todo in todos"> <span type="text" ng-model="todo" class="todos">{{ todo }}</span> <button class="btn btn-danger" ng-click="removeTodo($index)">X</button> </p> </div>')}]);